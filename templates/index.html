<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=0.5, maximum-scale=2.0, user-scalable=yes" /> 
        <title>æ¬¢è¿ä½¿ç”¨Nino</title>
        <script src="https://upcdn.b0.upaiyun.com/libs/jquery/jquery-2.0.2.min.js"></script>
    </head>
    <body>
        <div class="layout-container">
            <div class="left-image">
                <img src="{{ left_image }}" alt="ä¸»é¢˜å›¾ç‰‡" class="theme-image">
            </div>
            
            <div class="right-content">
                <div id="menu">
                    <h1>NinoğŸ¥</h1>
                    <span><a href="/data">æ•°æ®ä¸­å¿ƒ</a> | <a href="#" id="config">è®¾ç½®</a> | <a href="#" id="about">å…³äº</a></span>
                </div>
                <div id="talk">
                    {% for content, content_type in context_list | zip(context_type_list) %}
                        <span class="message {{ content_type }}">{{ content }}</span>
                    {% endfor %}
                    <span class="message user" id="submit_show_user"></span>
                    <span class="message shell" id="submit_show_shell">ç­‰å¾…å¯¹æ–¹å›å¤...</span>
                    <form action="/send" method="post" id="form" enctype="multipart/form-data">
                        <div id="user-input-from">
                            <input type="text" required maxlength="100" name="content" id="content" placeholder="å‘é€æ¶ˆæ¯...">
                            <input type="file" name="attachment_file" id="attachment_file" accept=".txt">
                            <input type="submit" value="å‘é€" id="submit" >
                        </div>
                        <input type="checkbox" {% if reasoner %} checked="on" {% endif %} name="reasoner" id="reasoner">
                        <label for="reasoner" id="reasoner-text">ä½¿ç”¨æ€è€ƒæ¨¡å‹</label>
                        <input type="checkbox" {% if memory %} checked="on" {% endif %} name="memory" id="memory">
                        <label for="memory" id="memory-text">å…è®¸å†™å…¥é•¿æœŸè®°å¿†</label>
                    </form>
                </div>
            </div>
        </div>

        <div class="modal-mask"></div>
        <div class="modal">
            <span class="modal-close">X</span>
            <div class="modal-content">
                <h2 class="modal-title">NinoğŸ¥</h2>
                <p class="modal-version">ver 1.7.0</p>
                <div class="modal-info">
                    <p>ä½œè€…ï¼šPinpe</p>
                    <p>é¸£è°¢ï¼šlyp0746</p>
                    <p>æŠ€æœ¯æ ˆï¼šPythonã€Flaskã€jQuery</p>
                    <p>ä¾èµ–ï¼šflaskã€requestsã€openai</p>
                    <p>å¼€æºåè®®ï¼šGPL-3</p>
                    <p>å®˜ç½‘ï¼š<a href="https://pinpe.top" target="_blank" class="modal-link">pinpe.top</a></p>
                </div>
                <div class="modal-desc">
                    <p>Ninoæ˜¯AIèŠå¤©è½¯ä»¶ï¼Œä¼šå°è¯•äº†è§£ä½ ï¼Œç†è§£ä½ ï¼Œå¹¶ä¸”å¯ä»¥æ°¸è¿œè®°ä½é‡è¦è®°å¿†ï¼Œä¼šæ ¹æ®ç”¨æˆ·è¾“å…¥ã€ä¸Šä¸‹æ–‡ã€é•¿æœŸè®°å¿†åº“å’Œå¤–éƒ¨ç¯å¢ƒå¯¹ä½ è¿”å›å¯çˆ±çš„å›å¤ï¼Œå¯ç”¨äºèŠå¤©å’Œæ—¥å¸¸å¿ƒç†è°ƒé€‚ã€‚</p>
                    <p>Ninoæ˜¯å¼€æºçš„ï¼Œè·¨å¹³å°çš„ï¼Œè½»é‡çº§çš„ï¼ŒNinoçš„æ‰€æœ‰æ•°æ®å‡åœ¨æœ¬åœ°ï¼Œä»…åœ¨éœ€è¦æ—¶ä¼šæŠŠä¸€éƒ¨åˆ†æ•°æ®å‘é€ç»™ç¬¬ä¸‰æ–¹APIã€‚</p>
                    <p>è¯·æ³¨æ„ï¼šAIçš„å›å¤å¯èƒ½ä¼šå› ä¸ºå¹»è§‰å¯¼è‡´äº‹å®ã€è§‚ç‚¹ç­‰é”™è¯¯ï¼Œä¸ä¸€å®šæ˜¯å®Œå…¨æ­£ç¡®çš„ï¼Œè¯·æœ‰åŸºæœ¬çš„åˆ¤æ–­èƒ½åŠ›ï¼ŒNinoåŠå…¶ä½œè€…ä¸ä¸ºæ­¤ä»˜å‡ºä»»ä½•è´£ä»»ã€‚</p>
                </div>
            </div>
        </div>
        <div class="config-modal">
            <span class="config-modal-close">X</span>
            <div class="config-modal-content">
                <h1>è®¾ç½®</h1>
                <div class="modal-desc"><p>ä½ å¯ä»¥åœ¨è¿™é‡Œä¿®æ”¹Ninoçš„é…ç½®ï¼Œè¿™é‡Œçš„é€‰é¡¹å°†æ°¸ä¹…å­˜å‚¨ï¼Œæ­¤å¡ç‰‡ä¹Ÿä¼šåœ¨ç¬¬ä¸€æ¬¡ä½¿ç”¨æ—¶å¼¹å‡ºã€‚</p></div>
                <form action="/config" method="post">
                        <input type="checkbox" {% if show_memory %} checked="on" {% endif %} name="show-memory" id="show-memory">
                        <label for="show-memory" id="show-memory-text" style="margin-bottom: 15px;">æ˜¾ç¤ºæ–°æ·»åŠ çš„é•¿æœŸè®°å¿†</label><br>
                        <label for="location" id="location-text">å±…ä½åŸå¸‚ï¼š</label>
                        <input type="text" value="{{ location }}" required maxlength="5" name="location" id="location" style="margin-bottom: 10px;"><br>
                        <label for="left-image" id="location-text">èƒŒæ™¯å›¾URLï¼š</label>
                        <input type="text" value="{{ left_image }}" required name="left-image" id="left-image-src" style="margin-bottom: 10px;">
                        <label for="left-image" id="location-text">æ¨¡å‹çš„base_urlï¼š</label>
                        <input type="text" value="{{ model_base_url }}" required name="model-base-url" id="left-image-src" style="margin-bottom: 10px;">
                        <label for="left-image" id="location-text">æ€è€ƒæ¨¡å‹åç§°ï¼š</label>
                        <input type="text" value="{{ reasoner_model }}" required name="reasoner-model" id="location" style="margin-bottom: 10px; width: 180px;"><br>
                        <label for="left-image" id="location-text">éæ€è€ƒæ¨¡å‹åç§°ï¼š</label>
                        <input type="text" value="{{ common_model }}" required name="common-model" id="location" style="margin-bottom: 15px; width: 180px;">
                        <br>
                        <input type="submit" value="ä¿å­˜å¹¶å…³é—­" id="submit" >
                </form>
            </div>
        </div>

        <script>
            $(function(){
                first_use = ({{ first_use }});
                
                // åˆå§‹çŠ¶æ€éšè—
                $('#submit_show_user').hide();
                $('#submit_show_shell').hide();
                $('.modal-mask, .modal, .config-modal').hide();

                if (first_use == true) {
                    // å¦‚æœæ˜¯é¦–æ¬¡ä½¿ç”¨ï¼Œä¼˜é›…åœ°æ˜¾ç¤ºè®¾ç½®å¼¹çª—
                    $('.modal-mask').fadeIn(5);
                    $('.config-modal').show(); // CSSåŠ¨ç”»å¤„ç†å¼¹å‡ºæ•ˆæœ
                }
            })

            $('#form').submit(function(){
                $('#submit').attr('disabled', 'true')
                $('#submit_show_user').text($('#content').val()).show()
                $('#submit_show_shell').show()
            })

            // å…³äºæŒ‰é’®ç‚¹å‡»äº‹ä»¶ - æ·»åŠ åŠ¨ç”»æ•ˆæœ
            $('#about').click(function(e){
                e.preventDefault();
                $('.modal-mask').fadeIn(5); // èƒŒæ™¯æ¸æ˜¾
                $('.modal').show(); // å¡ç‰‡å¼¹å‡º (CSS Animation)
            })

            // è®¾ç½®æŒ‰é’®ç‚¹å‡»äº‹ä»¶ - æ·»åŠ åŠ¨ç”»æ•ˆæœ
            $('#config').click(function(e){
                e.preventDefault();
                $('.modal-mask').fadeIn(5);
                $('.config-modal').show();
            })

            // å…³é—­å¼¹çª— - æ·»åŠ åŠ¨ç”»æ•ˆæœ
            $('.modal-close, .config-modal-close').click(function(){
                $('.modal-mask').fadeOut(0); // èƒŒæ™¯æ¸éš
                // å¡ç‰‡æ¸éš (jQueryçš„fadeOutä¼šå¤„ç†opacityï¼Œè¦†ç›–CSSåŠ¨ç”»ç»“æŸçŠ¶æ€)
                $('.config-modal, .modal').fadeOut(0); 
            })
        </script>

        <style>
            @font-face {
                font-family: font;
                src: url({{ url_for('static', filename='font.ttf') }});
            }
            * {
                font-family: font;
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                background-color: #fff9f0;
                color: #5D4037;
                min-height: 100vh;
                padding: 0;
                margin: 0 auto;
                line-height: 1.6;
            }

            #menu a{
                color: #5D4037;
                text-decoration: none;
                transition: all 0.15s ease;
            }

            #menu a:hover{
                background-color: #00000019;
            }

            .layout-container {
                width: 100%;
                min-height: 100vh;
            }

            /* å·¦ä¾§å›¾ç‰‡ç»å¯¹å›ºå®š */
            .left-image {
                position: fixed;
                top: 0;
                left: 0;
                width: 33.333%;
                height: 100vh;
                overflow: hidden;
                z-index: 999;
            }

            .theme-image {
                width: 100%;
                height: 100%;
                object-fit: cover;
                object-position: center;
                display: block;
            }

            /* å³ä¾§å†…å®¹åŒºé¿å¼€å·¦ä¾§å›ºå®šåŒºåŸŸ */
            .right-content {
                width: 66.666%;
                min-height: 100vh;
                padding: 20px 15px;
                max-width: 800px;
                margin-left: 40%;
                overflow-y: auto;
            }

            title {
                display: none;
            }

            #talk {
                padding: 25px 20px;
                margin-bottom: 30px;
                display: flex;
                flex-direction: column;
                gap: 10px;
            }

            .message {
                display: inline-block;
                padding: 10px 18px;
                border-radius: 22px;
                max-width: 75%;
                word-wrap: break-word;
            }

            .message.user {
                background-color: #FFE0B2;
                margin-left: auto;
            }

            .message.ai {
                background-color: #ffefd8;
                margin-right: auto;
            }

            .message.shell{
                color: #5d403783;
                margin-left: auto;
                margin-right: auto;
            }

            #menu{
                padding: 25px 40px;
            }

            form{
                align-items: center;
                padding: 15px 20px;
            }

            #user-input-from {
                display: flex;
                flex-wrap: wrap;
                gap: 12px;
                margin-bottom: 12px;
            }

            #reasoner, #memory, #show-memory {
                accent-color: #FFE0B2;
                display: inline-block;
            }
            #memory{
                margin-left: 20px;
            }

            label {
                color: #795548;
                font-size: 14px;
                cursor: pointer;
                display: inline-block;
            }

            #content {
                flex: 1;
                min-width: 200px;
                padding: 12px 15px;
                border: 2px solid #FFE0B2;
                border-radius: 25px;
                font-size: 15px;
                transition: all 0.3s ease;
            }

            #content::placeholder {
                color: #D7CCC8;
            }

            #content:focus {
                outline: none;
                border-color: #FF9800;
            }

            #location, #left-image-src {
                padding: 5px 15px;
                width: 100px;
                border: 2px solid #FFE0B2;
                border-radius: 25px;
                font-size: 15px;
                transition: all 0.3s ease;
            }

            #left-image-src{
                width: 400px;
            }

            #location:focus {
                outline: none;
                border-color: #FF9800;
            }

            #left-image-src:focus{
                outline: none;
                border-color: #FF9800;
            }

            #submit, input::file-selector-button {
                background-color: #FFE0B2;
                border: none;
                padding: 12px 25px;
                border-radius: 25px;
                font-size: 15px;
                font-weight: 500;
                cursor: pointer;
                transition: all 0.1s ease;
                color: #5D4037;
            }

            #submit:hover {
                transform: translateY(-2px);
            }

            #submit:active {
                transform: translateY(0);
            }

            #attachment_file{
                width: 114px;
            }

            /* æ–°å¢ï¼šå¼¹çª—åŠ¨ç”»å®šä¹‰ */
            @keyframes modal-in {
                0% {
                    opacity: 0;
                    transform: translate(-50%, -40%) scale(0.95);
                }
                100% {
                    opacity: 1;
                    transform: translate(-50%, -50%) scale(1);
                }
            }

            /* æ–°å¢ï¼šå¼¹çª—æ ·å¼ */
            .modal-mask {
                position: fixed;
                top: 0;
                left: 0;
                width: 100vw;
                height: 100vh;
                background-color: rgba(0, 0, 0, 0.3);
                z-index: 1000;
                backdrop-filter: blur(5px); /* ç¨å¾®è°ƒå°äº†ä¸€ç‚¹æ¨¡ç³Šï¼Œæå‡æ€§èƒ½ */
                transition: opacity 0.3s ease; /* æ·»åŠ è¿‡æ¸¡ */
            }

            .modal, .config-modal {
                position: fixed;
                top: 50%;
                left: 50%;
                /* transform ç”±åŠ¨ç”»æ§åˆ¶ï¼Œåˆå§‹çŠ¶æ€åœ¨ keyframes 0% ä¸­å®šä¹‰ */
                transform: translate(-50%, -50%); 
                background-color: #fff9f0;
                border-radius: 20px;
                padding: 30px;
                width: 100%;
                max-width: 850px;
                z-index: 1001;
                box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2); /* é˜´å½±åŠ æ·±ä¸€ç‚¹æ›´æœ‰å±‚æ¬¡æ„Ÿ */
                
                /* åº”ç”¨åŠ¨ç”»ï¼šå½“ display: block æ—¶è§¦å‘ */
                animation: modal-in 0.2s cubic-bezier(0.165, 0.84, 0.44, 1) forwards;
            }

            .config-modal{
                max-width: 550px;
            }

            .modal-desc p {
                margin-bottom: 8px;
            }

            .modal-close, .config-modal-close {
                position: absolute;
                top: 15px;
                right: 20px;
                font-size: 18px;
                color: #5D4037;
                cursor: pointer;
                transition: all 0.2s ease;
                width: 32px;
                height: 32px;
                border-radius: 50%;
                background-color: #f5f0e6;
                display: flex;
                align-items: center;
                justify-content: center;
                line-height: 1;
            }

            .modal-close:hover {
                background-color: #ede5d8;
            }

            .config-modal-close:hover {
                background-color: #ede5d8;
            }

            .modal-content {
                text-align: center;
                margin-top: 10px;
            }

            .modal-title {
                font-size: 55px;
                color: #5D4037;
                margin-bottom: 8px;
            }

            .modal-version {
                font-size: 14px;
                color: #795548;
                margin-bottom: 20px;
                margin-top: -10px;
            }

            .modal-info {
                margin-bottom: 20px;
                line-height: 1.8;
                text-align: left;
            }

            .modal-link {
                color: #5D4037;
                text-decoration: none;
                transition: text-decoration 0.2s ease;
            }

            .modal-link:hover {
                text-decoration: underline;
            }

            .modal-desc {
                color: #5D4037;
                line-height: 1.8;
                text-align: left;
            }

            /* å“åº”å¼è°ƒæ•´ */
            @media (max-width: 768px) {
                .left-image {
                    position: relative;
                    width: 100%;
                    height: 30vh;
                }
                .right-content {
                    width: 100%;
                    min-height: 70vh;
                    margin-left: 0;
                    padding: 20px 15px;
                }
                #menu {
                    padding: 25px 20px;
                }
                /* å¼¹çª—å“åº”å¼è°ƒæ•´ */
                .modal {
                    padding: 25px 20px;
                    max-width: 95%;
                }
                .modal-title {
                    font-size: 28px;
                }
            }
        </style>
    </body>
</html>